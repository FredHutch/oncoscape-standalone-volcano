<!-- <div style="margin: 10px">
  <app-py-button></app-py-button>
  <app-counter></app-counter>
</div> -->


<div class="container">
  <svg [id]="'volcano-'+1"></svg>
  <div id="side-bar">
      <h4>Interactivity Tips</h4>
      <p>- Hold down the shift key to select multiple points</p>
      <p>- Drag to select a region</p>
      <p>- Drag while holding shift to add a region to the selection</p>
      <p>- Drag while holding alt to deselect a region</p>
      <div style="margin-top: 20px;"><b>Selected Genes</b><span id="num-genes-selected" *ngIf="selectedPoints.length > 0"> ({{selectedPoints.length}} Genes)</span></div>
      <form [formGroup]="filterForm" style="font-size: 12px;" id="filter-form">
        <mat-form-field appearance="outline">
          <mat-label>Search Genes</mat-label>
          <input
          type="text"
          aria-label="Search Genes"
          matInput
          formControlName="geneName"
          (keyup)="applyFilter()"
          placeholder="Enter gene name"
          >
        </mat-form-field>

        <mat-button-toggle-group
        formControlName="regulation"
        aria-label="Regulation"
        style="margin-left: 10px"
        >
          <mat-button-toggle value="all" (click)="applyFilter()">All</mat-button-toggle>
          <mat-button-toggle value="upregulated" (click)="applyFilter()">
            <span>
              <mat-icon
              style="color: #0ac924; font-size: small"
              matTooltip="upregulated"
              >arrow_upward</mat-icon>
            </span>

            Upregulated</mat-button-toggle>
          <mat-button-toggle value="downregulated" (click)="applyFilter()">
            <span>
              <mat-icon  style="color: #c90a0a; font-size: small" matTooltip="downregulated">arrow_downward</mat-icon>
            </span>
            Downregulated</mat-button-toggle>
        </mat-button-toggle-group>
      </form>
      <!-- Import MatTableDataSource and MatSort from @angular/material -->
      <mat-table [dataSource]="dataSource" matSort id="selected-genes" (matSortChange)="handleSortChange($event)">

        <ng-container matColumnDef="select">
          <th mat-header-cell *matHeaderCellDef>
            Show label
            <br/>
            <mat-checkbox (change)="$event ? toggleAllRows() : null"
                          [checked]="selection.hasValue() && isAllSelected()"
                          [indeterminate]="selection.hasValue() && !isAllSelected()"

                          >

            </mat-checkbox>
            <!-- Show label -->
          </th>
          <td mat-cell *matCellDef="let row">
            <mat-checkbox (click)="$event.stopPropagation()"
                          (change)="$event ? selection.toggle(row) : null"
                          [checked]="selection.isSelected(row)">
                          <!-- This is to adjust for the "Show label" label on the checkbox column header -->
                          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                          <!-- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -->
            </mat-checkbox>
          </td>
        </ng-container>

        <!-- Define the columns for the MatTable -->
        <ng-container matColumnDef="rank">
          <mat-header-cell *matHeaderCellDef>Significance<br/>Rank</mat-header-cell>
          <mat-cell *matCellDef="let point">{{ selectedPoints.indexOf(point) + 1 }}</mat-cell>
        </ng-container>

        <!-- Define the columns for the MatTable -->
        <ng-container matColumnDef="x">
          <mat-header-cell *matHeaderCellDef mat-sort-header>LogFC</mat-header-cell>
          <mat-cell *matCellDef="let point">
            <span *ngIf="point.x > 0">
              <mat-icon
              style="color: #0ac924; font-size: small; padding-top: 50%"
              matTooltip="upregulated"
              >arrow_upward</mat-icon>
            </span>
            <span *ngIf="point.x < 0">
              <mat-icon  style="color: #c90a0a; font-size: small; padding-top: 50%" matTooltip="downregulated">arrow_downward</mat-icon>
            </span>

            {{ point.x | number:"1.5"}}

          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="y">
          <mat-header-cell *matHeaderCellDef mat-sort-header>p-value</mat-header-cell>
          <mat-cell *matCellDef="let point">{{ point.y | scientific:'5' }}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="gene">
          <mat-header-cell *matHeaderCellDef>Gene</mat-header-cell>
          <mat-cell *matCellDef="let point">{{ point.gene }}</mat-cell>
        </ng-container>

        <!-- Set up MatTable's header row and columns -->
        <mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>
        <mat-row *matRowDef="let row; columns: displayedColumns"></mat-row>

      </mat-table>
  </div>
</div>

