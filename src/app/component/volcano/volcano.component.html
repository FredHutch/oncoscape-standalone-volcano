<div class="volcano-container">
  <div>
    <svg [id]="'volcano-' + id"></svg>
  </div>

  <div id="side-bar">
    <mat-expansion-panel
      [hideToggle]="false"
      [expanded]="true"
      (opened)="selectByStatsFormCollapsed = false"
      (closed)="selectByStatsFormCollapsed = true"
      id="select-by-stats-exp-panel"
      style="margin-bottom: 10px"
    >
      <mat-expansion-panel-header>
        <mat-panel-title style="text-transform: none"
          >Select by Statistical Thresholds</mat-panel-title
        >
      </mat-expansion-panel-header>
      <div id="select-by-stats">
        <mat-form-field style="width: 100px">
          <mat-label>-log<sub>10</sub>(p-adjusted)</mat-label>
          <input
            matInput
            type="number"
            id="nlogpadj"
            name="nlogpadj"
            step="0.05"
            [(ngModel)]="selectByStatsForm.nlogpadj"
          />
        </mat-form-field>
        <mat-form-field style="width: 100px">
          <mat-label>Log2 Fold Change</mat-label>
          <input
            matInput
            type="number"
            id="log2FoldChange"
            name="log2FoldChange"
            step="0.05"
            [(ngModel)]="selectByStatsForm.log2FoldChange"
          />
        </mat-form-field>
        <button mat-flat-button color="primary" (click)="selectByStats()">
          Select
        </button>
        <mat-form-field>
          <mat-label>Downregulated gene color</mat-label>
          <input
            matInput
            type="color"
            [value]="selectByStatsForm.downregulatedColor"
            (change)="updateRegulationColor($event.target.value, 'down')"
          />
        </mat-form-field>
        <mat-form-field>
          <mat-label>Upregulated gene color</mat-label>
          <input
            matInput
            type="color"
            [value]="selectByStatsForm.upregulatedColor"
            (change)="updateRegulationColor($event.target.value, 'up')"
          />
        </mat-form-field>
      </div>
    </mat-expansion-panel>

    <app-volcano-gene-table
      [upregulatedColor]="selectByStatsForm.upregulatedColor"
      [downregulatedColor]="selectByStatsForm.downregulatedColor"
      [getGeneRegulation]="getGeneRegulation.bind(this)"
      [selectByStatsFormCollapsed]="selectByStatsFormCollapsed"
      [selectedPoints]="emittedPoints"
      (selectionChanged)="labelPoints($event)"
    ></app-volcano-gene-table>
    <div *ngIf="emittedPoints.length === 0" id="no-genes">
      <h4>Interactivity Tips</h4>
      <p>- Click on a point to select a gene</p>
      <p>- Hold down the shift key to select multiple points</p>
      <p>- Drag to select a region</p>
      <p>- Drag while holding shift to add a region to the selection</p>
      <p>- Drag while holding alt to deselect a region</p>
    </div>
  </div>
</div>
